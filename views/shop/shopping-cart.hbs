{{# if books }}
	<div class="row">
		<div class="col-md-4 col-sm-6 offset-md-3 offset-sm-3">
			<ul class="list-group marg">
				{{# each books}}
					<li class="list-group-item pad">
						<strong>{{this.item.title}}</strong>
						<span class="badge badge-success">{{this.price}}</span>
						<div class="btn-group">
							<button type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			    			Action
			  				</button>
			  				<div class="dropdown-menu">
							    <a class="dropdown-item" href="#">Action</a>
							    <a class="dropdown-item" href="#">Reduce by 1</a>
							    <a class="dropdown-item" href="#">Remove all</a>
						  	</div>
						</div>
						<span class="badge badge-secondary spec">{{this.qty}}</span>
					</li>
				{{/each}}
			</ul>
		</div>	
	</div>
	<div class="row">
		<div class="col-md-4 col-sm-6 offset-md-3 offset-sm-3">
			<strong>Total: <span id="total">{{totalPrice}}</span></strong>
		</div>
	</div>
	<hr>	
	<div class="row">
		<div class="col-md-4 col-sm-6 offset-md-3 offset-sm-3">
			<a href="/checkout" type="button"class="btn btn-success">Checkout</a>
		</div>	
	</div>
	<div id="paypal-button-container"></div>

{{else}}
	<div class="row">
		<div class="col-md-4 col-sm-6 offset-md-3 offset-sm-3">
			<h2>No items in cart<h2>
		</div>
	</div>
{{/if}}
<script src="https://www.paypal.com/sdk/js?client-id=ASMvQeafoArGMg57vls5u1dYEBzarXEbaawj0UJBo-JUX-XypB9_2sQyTbksgi-LQROoNhktZny2hvDB&currency=USD"></script>

<script>
	var totalPrice = {{{totalPrice}}};
	paypal.Buttons({
	  style: {
	    layout: 'horizontal'
	  },
	  // Set up the transaction
	  createOrder: function(data, actions) {
	    //var totalPrice = JSON.parse(totalPrice);
	      return actions.order.create({
	      	  //redirect_urls: {
	      	  	//return_url:"http://localhost:3000"
	      	  	//cancel_url: "http://localhost:3000"
	      	  //},
	          purchase_units: [{
	              amount: {
	                  
	                  value: totalPrice
	                  //currency_code: 'USD'
	              }
	          }],
	          
	      });
	  },
	  commit: true,
	  // Finalize the transaction
	  onApprove: function(data, actions) {
	      return actions.order.capture().then(function(details) {
	          // Show a success message to the buyer
	          //return actions.redirect();
	          alert('Transaction completed by ' + details.payer.name.given_name + '!');
	          //actions.redirect();
	          //windows.alert
	          
	          window.location.href= "/"
	          //req.session.cart = null;
	          //res.redirect("/")
	      });
	  },
	  onCancel: function(data, actions) {
    	actions.redirect();
      },
      onError: function(err){
      	console.log(err);
      }
	}).render('#paypal-button-container');
</script>

